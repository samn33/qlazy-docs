

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>密度演算子(DensOpクラス) &mdash; qlazy  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> qlazy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Tutorial_en.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Tutorial_jp.html">Tutorial (japanese)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../python-api/qlazy.html">qlazy package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">qlazy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>密度演算子(DensOpクラス)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/jp/py/usage/densop_jp.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="densop">
<h1>密度演算子(DensOpクラス)<a class="headerlink" href="#densop" title="Permalink to this heading">¶</a></h1>
<div class="section" id="id1">
<h2>密度演算子の操作<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h2>
<p>量子状態には純粋状態と混合状態があります。混合状態は、複数の純粋状態が
ある確率でもって出現するアンサンブル{p(i), |phi(i)&gt;} (i=0,1,2,…)とし
て定義されます。このような混合状態も含めて、量子状態を統一的に記述する
便利な記法として「密度演算子」が導入されました。その定義は、密度演算子
をrhoとすると、「rho = ∑_i p(i) |phi(i)&gt;&lt;phi(i)|」です。</p>
<p>qlazyには、通常の量子状態の集合から密度演算子をつくり、各種計算する機
能があります。</p>
<div class="section" id="id2">
<h3>生成・初期化<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<p>DensOpクラスが密度演算子を表します。使用例を以下に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qlazy</span> <span class="kn">import</span> <span class="n">QState</span><span class="p">,</span><span class="n">DensOp</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qs1</span> <span class="o">=</span> <span class="n">QState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qs2</span> <span class="o">=</span> <span class="n">QState</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span> <span class="o">=</span> <span class="n">DensOp</span><span class="p">(</span><span class="n">qstate</span><span class="o">=</span><span class="p">[</span><span class="n">qs1</span><span class="p">,</span><span class="n">qs2</span><span class="p">],</span> <span class="n">prob</span><span class="o">=</span><span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.7</span><span class="p">])</span>
</pre></div>
</div>
<p>２つの量子状態qs1,qs2があったとき、DensOpの引数として、量子状態のリス
トと各々の出現確率を表すリストを与えると、密度演算子のインスタンスが返っ
てきます。量子状態は、何個指定しても良いです（メモリが許す限り）。ただ
し、指定する量子状態の量子ビットはすべて一致していなければなりません。
また、probを省略した場合、各量子状態が等しい確率で混合しているものとし
て密度演算子が計算されます。</p>
<p>numpyの行列（２次元配列）を指定して生成することもできます。使い方は、
以下です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span> <span class="o">=</span> <span class="n">DensOp</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">mat</span><span class="p">)</span>
</pre></div>
</div>
<p>行列の次元は2のべき乗である必要があります。</p>
</div>
<div class="section" id="id3">
<h3>ゲート演算<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>密度演算子として表現された量子状態に対してゲート演算することができます。
適用するゲート演算子をU、密度演算子をrhoとしたとき、「U * rho * U^」
という行列計算を実行しています。仕様はQStateクラスの場合と全く同じです。
以下に使用例を示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">crx</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
</pre></div>
</div>
<div class="section" id="id4">
<h4>カスタム・ゲートの追加<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h4>
<p>DensOpクラスを継承することで、自分専用の量子ゲートを簡単に作成・追加す
ることができます。ベル状態を作成する回路をbellメソッドとして、DensOpを
継承したMyDensOpクラスに追加する例を示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyDensOp</span><span class="p">(</span><span class="n">DensOp</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">bell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">q0</span><span class="p">)</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="bp">self</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span> <span class="o">=</span> <span class="n">MyDensOp</span><span class="p">(</span><span class="n">qubit_num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">bell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
</pre></div>
</div>
<p>これは非常に簡単な例なのであまりご利益を感じないかもしれませんが、大規
模な量子回路を作成したい場合など、便利に使える場面は多いと思います。</p>
</div>
</div>
<div class="section" id="id5">
<h3>パウリ積の演算<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<p>パウリ演算子X,Y,Zのテンソル積を定義して密度演算子に演算することができま
す。パウリ積を扱うために、まず、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">qlazy</span> <span class="kn">import</span> <span class="n">DensOp</span><span class="p">,</span> <span class="n">PauliProduct</span>
</pre></div>
</div>
<p>のようにPauliProductクラスをimportする必要があります。例えば、3量子ビッ
トの密度演算子deに対して、X2 Y0 Z1というパウリ積を演算したい場合、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">PauliProduct</span><span class="p">(</span><span class="n">pauli_str</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">pp</span><span class="o">=</span><span class="n">pp</span><span class="p">)</span>
</pre></div>
</div>
<p>のようにoperateメソッドのppオプションにPauliProductのインスタンスを指
定します。制御化されたパウリ積はoperateメソッドのqctrlオプションに制御
量子ビット番号を指定することで実現できます。以下のようにします。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pp</span> <span class="o">=</span> <span class="n">PauliProduct</span><span class="p">(</span><span class="n">pauli_str</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qs</span><span class="o">.</span><span class="n">operate</span><span class="p">(</span><span class="n">pp</span><span class="o">=</span><span class="n">pp</span><span class="p">,</span> <span class="n">qctlr</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>量子チャネル<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<p>密度演算子に対して、いくつかの代表的な量子チャネルを適用することができます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">bit_flip</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">xxx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">phase_flip</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">xxx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">bit_phase_flip</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">xxx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">depolarize</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">xxx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">amp_dump</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">xxx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">phase_dump</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">xxx</span><span class="p">)</span>
</pre></div>
</div>
<p>上から順に、「ビット反転」、「位相反転」、「ビット・位相反転」、「分極
解消」、「振幅ダンピング」、「位相ダンピング」です。引数のqは適用した
い量子ビット番号です。probは（雑音）適用の確率を表すパラメータです。各々
の量子チャネルが何を意味するかについては、例えば、ニールセン・チャンの
「量子コンピュータと量子通信３」を参照してください。</p>
</div>
<div class="section" id="id7">
<h3>メモリ解放<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h3>
<p>密度演算子インスタンスのメモリは使用されなくなったら自動的に解放されますが、
明示的に解放したい場合、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">del</span> <span class="n">de</span>
</pre></div>
</div>
<p>とすれば好きなタイミングで解放することができます。</p>
<p>クラス・メソッド’del_all’を使えば複数の密度演算子のインスタンスを一気に
解放することができます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de_0</span> <span class="o">=</span> <span class="n">DensOp</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">mat</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de_1</span> <span class="o">=</span> <span class="n">DensOp</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">mat</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de_2</span> <span class="o">=</span> <span class="n">DensOp</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">mat</span><span class="p">)</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DensOp</span><span class="o">.</span><span class="n">del_all</span><span class="p">(</span><span class="n">de_0</span><span class="p">,</span> <span class="n">de_1</span><span class="p">,</span> <span class="n">de_2</span><span class="p">)</span>
</pre></div>
</div>
<p>このとき、引数に指定するのは密度演算子のリストやタプルであっても良いで
すし、それらの入れ子でもOKです。例えば、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de_A</span> <span class="o">=</span> <span class="p">[</span><span class="n">de_1</span><span class="p">,</span> <span class="n">de_2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DensOp</span><span class="o">.</span><span class="n">del_all</span><span class="p">(</span><span class="n">de_0</span><span class="p">,</span> <span class="n">de_A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de_B</span> <span class="o">=</span> <span class="p">[</span><span class="n">de_3</span><span class="p">,</span> <span class="p">[</span><span class="n">de_4</span><span class="p">,</span> <span class="n">de_5</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">DensOp</span><span class="o">.</span><span class="n">del_all</span><span class="p">(</span><span class="n">de_B</span><span class="p">)</span>
</pre></div>
</div>
<p>という指定の仕方でも大丈夫です。</p>
</div>
<div class="section" id="id8">
<h3>複製<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<p>密度演算子を複製することができます。シミュレータならではの機能です。以下
のようにcloneメソッドを呼び出します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de_clone</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>リセット<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h3>
<p>すでに生成済みの密度演算子を破棄することなく、再度初期化して使いたい場
合は、reset()メソッドを使います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
<p>とすれば、deは強制的に|00…0&gt;&lt;00…0|となります。これは、同じ量子回路
を何度も繰り返し適用しながら、何らかの統計量を得たいような場合に便利な
機能です。</p>
<p>また、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>のように、量子番号リストを引数で与えると、その番号に対応した量子ビット
のみを強制的に|0&gt;にすることもできます。</p>
</div>
</div>
<div class="section" id="id10">
<h2>密度演算子の表示<a class="headerlink" href="#id10" title="Permalink to this heading">¶</a></h2>
<div class="section" id="id11">
<h3>要素の表示<a class="headerlink" href="#id11" title="Permalink to this heading">¶</a></h3>
<p>DensOpクラスのshowメソッドを使います。使用例を以下に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>例えば、以下のように各行列要素の値が表示されます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">0.0000</span><span class="o">+</span><span class="mf">0.0000</span><span class="o">*</span><span class="n">i</span> <span class="p">:</span> <span class="mf">0.0000</span> <span class="o">|</span>
<span class="n">elm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">0.0000</span><span class="o">+</span><span class="mf">0.0000</span><span class="o">*</span><span class="n">i</span> <span class="p">:</span> <span class="mf">0.0000</span> <span class="o">|</span>
<span class="n">elm</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">0.0000</span><span class="o">+</span><span class="mf">0.0000</span><span class="o">*</span><span class="n">i</span> <span class="p">:</span> <span class="mf">0.0000</span> <span class="o">|</span>
<span class="n">elm</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.0000</span><span class="o">+</span><span class="mf">0.0000</span><span class="o">*</span><span class="n">i</span> <span class="p">:</span> <span class="mf">1.0000</span> <span class="o">|+++++++++++</span>
</pre></div>
</div>
<p>部分系の表示も可能です。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</div>
<p>例えば、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>とすると、0番目と3番目の量子ビットに関する密度演算子を表示します。内部
では0番目と3番目の量子ビット以外の量子ビットに関して部分トレースを実行
しています。</p>
</div>
<div class="section" id="id12">
<h3>非ゼロ要素のみ表示<a class="headerlink" href="#id12" title="Permalink to this heading">¶</a></h3>
<p>ゼロでない要素だけを表示したい場合、以下のように’nonzero’オプションを使えばできます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">nonzero</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>とすると、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">elm</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">+</span><span class="mf">1.0000</span><span class="o">+</span><span class="mf">0.0000</span><span class="o">*</span><span class="n">i</span> <span class="p">:</span> <span class="mf">1.0000</span> <span class="o">|+++++++++++</span>
</pre></div>
</div>
<p>のように非ゼロ要素のみが表示されます。</p>
</div>
<div class="section" id="id13">
<h3>要素の取得<a class="headerlink" href="#id13" title="Permalink to this heading">¶</a></h3>
<p>get_elmメソッドで取得できます。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">elm</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">get_elm</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elm</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">get_elm</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id14">
<h2>密度演算子に関する計算<a class="headerlink" href="#id14" title="Permalink to this heading">¶</a></h2>
<div class="section" id="id15">
<h3>トレース<a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h3>
<p>traceメソッドを使います。使用例を以下に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tr</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
</pre></div>
</div>
<p>密度演算子のトレースは理論的には「常に1である」ということになっている
ので、たいていの場合、あまり意味はないメソッドですが、密度演算子に対し
て、何らかの行列変換を適用しておいて(後述)、そのトレースを計算したい場
合があります。その場合、このメソッドを使うことで、計算できます。</p>
</div>
<div class="section" id="id16">
<h3>２乗のトレース<a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h3>
<p>DensOpクラスのsqtraceメソッドを使います。使用例を以下に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sqtr</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">sqtrace</span><span class="p">()</span>
</pre></div>
</div>
<p>密度演算子を２乗してから、そのトレースをとります。純粋状態の密度演算子
の場合、この値は1になり、混合状態の場合、1以下になることが、理論的にわ
かっています。このメソッドを使う典型的な状況は、純粋状態と混合状態を判
別したいときです。</p>
</div>
<div class="section" id="id17">
<h3>部分トレース<a class="headerlink" href="#id17" title="Permalink to this heading">¶</a></h3>
<p>DensOpクラスのpatraceメソッドを使います。使用例を以下に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de_reduced</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">patrace</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</div>
<p>全体系の部分系に対する密度演算子を知りたい場合に「部分トレース」という
処理を施せば良いということがわかっています。その計算を実行します。返却
値は、縮約された(部分系の)密度演算子インスタンスです。</p>
</div>
<div class="section" id="id18">
<h3>部分系<a class="headerlink" href="#id18" title="Permalink to this heading">¶</a></h3>
<p>部分トレースをとった残りの部分系を取得します。qidに取得したい部分系に
対応した量子ビット番号リストを指定します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de_partial</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">,</span><span class="o">...</span><span class="p">])</span>
</pre></div>
</div>
<p>patraceメソッドでは「捨てたい」量子ビット番号を指定するのに対し、
partialメソッドでは「残したい」量子ビット番号を指定します。引数の解釈
の違いを除けば、両者の内部処理は全く同じです。</p>
</div>
<div class="section" id="id19">
<h3>テンソル積<a class="headerlink" href="#id19" title="Permalink to this heading">¶</a></h3>
<p>２つの密度演算子のテンソル積を計算できます。使用例を以下に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">de_product</span> <span class="o">=</span> <span class="n">de_A</span><span class="o">.</span><span class="n">tenspro</span><span class="p">(</span><span class="n">de_B</span><span class="p">)</span>
</pre></div>
</div>
<p>密度演算子de_Aとde_Bのテンソル積(de_A (X) de_B)を計算し、新たな密度演
算子de_productを生成しています（(X)は丸付きの☓のつもり）。</p>
</div>
<div class="section" id="id20">
<h3>複合状態の生成<a class="headerlink" href="#id20" title="Permalink to this heading">¶</a></h3>
<p>compositeメソッドを使います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de_com</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">composite</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>全く同じdeを4つ複合した状態が生成されます。</p>
</div>
<div class="section" id="id21">
<h3>行列の適用<a class="headerlink" href="#id21" title="Permalink to this heading">¶</a></h3>
<p>applyメソッドを使います。使用例を以下に示します。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],[</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># 2番目の量子ビットにXゲート演算</span>
</pre></div>
</div>
<p>密度演算子rhoに対して変換行列Mがあったときに、「M * rho * M^」の
計算をします。行列はnumpyの２次元配列として用意しておきます。密度演算
子よりも変換行列のサイズの方が小さくなくてはいけません。また、qidで指定
する引数のリストのサイズをnとしたとき、行列の行数、列数はともに2^nでな
くてはなりません。applyメソッドは、元のインスタンスの内容を変えます。
ご注意ください。</p>
</div>
<div class="section" id="id22">
<h3>和とスカラー積<a class="headerlink" href="#id22" title="Permalink to this heading">¶</a></h3>
<p>addメソッド、mulメソッドを使います。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">de_0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<p>deにde_0を足して、さらに0.3倍する例です。add,mulはもとのインスタンスの
内容を変えます。</p>
</div>
<div class="section" id="id23">
<h3>密度演算子の混合<a class="headerlink" href="#id23" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span> <span class="o">=</span> <span class="n">DensOp</span><span class="o">.</span><span class="n">mix</span><span class="p">(</span><span class="n">densop</span><span class="o">=</span><span class="p">[</span><span class="n">de1</span><span class="p">,</span><span class="n">de2</span><span class="p">],</span> <span class="n">prob</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.8</span><span class="p">])</span>
</pre></div>
</div>
<p>量子状態ではなく、複数の密度演算子を用意し、その混合で新たな密度演算子
を生成することができます。</p>
</div>
<div class="section" id="id24">
<h3>確率<a class="headerlink" href="#id24" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">probability</span><span class="p">(</span><span class="n">povm</span><span class="o">=</span><span class="p">[</span><span class="n">E0</span><span class="p">,</span><span class="n">E1</span><span class="p">],</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">probability</span><span class="p">(</span><span class="n">kraus</span><span class="o">=</span><span class="p">[</span><span class="n">M0</span><span class="p">,</span><span class="n">M1</span><span class="p">],</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>kraus演算子(numpy行列)のリスト、またはPOVM演算子(numpy行列)のリストを
引数に指定し、qidで測定対象となる量子ビット番号リストを指定します。各々
の測定演算に対する確率値のリストを返します。qidで指定する引数のリスト
のサイズをnとしたとき、kraus演算子(numpy行列)、またはPOVM演算子の行数、
列数はともに2^nでなくてはなりません。</p>
</div>
<div class="section" id="cp-instrument">
<h3>測定（CP-instrument）<a class="headerlink" href="#cp-instrument" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">instrument</span><span class="p">(</span><span class="n">kraus</span><span class="o">=</span><span class="p">[</span><span class="n">M0</span><span class="p">,</span><span class="n">M1</span><span class="p">],</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">instrument</span><span class="p">(</span><span class="n">kraus</span><span class="o">=</span><span class="p">[</span><span class="n">M0</span><span class="p">,</span><span class="n">M1</span><span class="p">],</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">measured_value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>引数krausでKraus演算子(numpy行列)のリスト、引数qidで測定対象となる量子
ビット番号リストを指定します。密度演算子をKraus表現に変更します。これ
は測定を実行するがその結果を忘れた状況に相当します（非選択的）。引数
measured_valueに測定値（Kraus演算子番号）を指定すると、密度演算子が測
定後の状態に変化します（選択的）。ただし、正規化しないので、正規化した
い場合は、以下のようにトレースで確率を求めて、それで割る必要があります。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">de</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">factor</span><span class="o">=</span><span class="mf">1.0</span><span class="o">/</span><span class="n">prob</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id25">
<h3>フィデリティ（忠実度）<a class="headerlink" href="#id25" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fid</span> <span class="o">=</span> <span class="n">de1</span><span class="o">.</span><span class="n">fidelity</span><span class="p">(</span><span class="n">de2</span><span class="p">)</span>
</pre></div>
</div>
<p>密度演算子de1とde2のフィデリティを計算します。</p>
</div>
<div class="section" id="id26">
<h3>トレース距離<a class="headerlink" href="#id26" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dis</span> <span class="o">=</span> <span class="n">de1</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">de2</span><span class="p">)</span>
</pre></div>
</div>
<p>密度演算子de1とde2のトレース距離を計算します。</p>
</div>
<div class="section" id="id27">
<h3>スペクトル分解<a class="headerlink" href="#id27" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">qstate</span><span class="p">,</span><span class="n">prob</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">spectrum</span><span class="p">()</span>
</pre></div>
</div>
<p>密度演算子をスペクトル分解します。固有値（確率）のリストと固有ベクトル
（量子状態）のリストをリターンします。ちなみに、</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">de1</span> <span class="o">=</span> <span class="n">DensOp</span><span class="p">(</span><span class="n">qstate</span><span class="o">=</span><span class="n">qstate</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="n">prob</span><span class="p">)</span>
</pre></div>
</div>
<p>とやると、スペクトル分解の逆操作となり密度演算子は元に戻ります（計算誤
差を除き、ですが）。</p>
</div>
<div class="section" id="id28">
<h3>エントロピー（フォンノイマン・エントロピー）<a class="headerlink" href="#id28" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ent</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">entropy</span><span class="p">()</span>
</pre></div>
</div>
<p>密度演算子deのフォンノイマン・エントロピーを計算します。</p>
</div>
<div class="section" id="id29">
<h3>エンタングルメント・エントロピー<a class="headerlink" href="#id29" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ent_A</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>    <span class="c1"># for system A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ent_B</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>  <span class="c1"># for system B</span>
</pre></div>
</div>
<p>全体系に対する部分系のエントロピー（エンタングルメント・エントロピー）
を計算します。entropyメソッドに部分系を表す量子ビット番号リストを引数
として与えます。上の例では、全体系が５量子ビットで記述されている想定の
もとで、それに対する部分系A（量子ビット番号:[0,1]）および部分系B（量子
ビット番号:[2,3,4]）のエンタングルメント・エントロピーを計算しています。
全体系が純粋状態の場合、部分系Aと部分系Bのエンタングルメント・エントロ
ピーの値は一致します。</p>
</div>
<div class="section" id="id30">
<h3>条件付きエントロピー<a class="headerlink" href="#id30" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ent_cond</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">cond_entropy</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>部分系B（量子ビット番号:[2,3,4]）が定まったという条件のもとでの、部分
系A（量子ビット番号:[0,1]）の条件付きエントロピーを計算します。
S(A|B)=S(A,B)-S(A)と定義されます。古典情報理論における条件付きエントロ
ピーと違い、負の値になる場合もあります。</p>
</div>
<div class="section" id="id31">
<h3>相互情報量<a class="headerlink" href="#id31" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mut_info</span> <span class="o">=</span> <span class="n">de</span><span class="o">.</span><span class="n">mutual_info</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>部分系A（量子ビット番号:[0,1]）と部分系B（量子ビット番号:[2,3,4]）の相
互情報量を計算します。I(A:B)=S(A)+S(B)-S(A,B)と定義されます。AとBを入
れ替えても同じ値になります。</p>
</div>
<div class="section" id="id32">
<h3>相対エントロピー<a class="headerlink" href="#id32" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rel_ent</span> <span class="o">=</span> <span class="n">de1</span><span class="o">.</span><span class="n">relative_entropy</span><span class="p">(</span><span class="n">de2</span><span class="p">)</span>
</pre></div>
</div>
<p>密度演算子de1とde2の相対エントロピーを計算します。</p>
<p>以上</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021-2022, Sam.N.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>