

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>qlazy.QState &mdash; qlazy  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> qlazy
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorial_jp.html">Tutorial (japanese)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python-api/qlazy.html">qlazy package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">qlazy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>qlazy.QState</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for qlazy.QState</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">qlazy.config</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qlazy.error</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qlazy.MData</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qlazy.Observable</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qlazy.PauliProduct</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">qlazy.lib.qstate_mcx</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">MDATA_TABLE</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="QState"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState">[docs]</a><span class="k">class</span> <span class="nc">QState</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Quantum State</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    qubit_num : int</span>
<span class="sd">        qubit number of the quantum state (= log(state_num)).</span>
<span class="sd">    state_num : int</span>
<span class="sd">        dimension of the quantum state vector (= 2**qubit_num).</span>
<span class="sd">    amp : list of complex</span>
<span class="sd">        elements of the quantum state vector.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;qubit_num&#39;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;state_num&#39;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;buf_id&#39;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;camp&#39;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;buffer_0&#39;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;buffer_1&#39;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;gbank&#39;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">qubit_num</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qubit_num : int</span>
<span class="sd">            qubit number of the quantum state.</span>
<span class="sd">        vector : list</span>
<span class="sd">            elements of the quantum state vector.</span>
<span class="sd">        seed : int, default - set randomly</span>
<span class="sd">            seed for random generation for meaurement.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        You must specify either &#39;qubit_num&#39; or &#39;vector&#39;, not both.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000000</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">qubit_num</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">qubit_num</span> <span class="o">&gt;</span> <span class="n">MAX_QUBIT_NUM</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;qubit number must be </span><span class="si">{0:d}</span><span class="s2"> or less.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">MAX_QUBIT_NUM</span><span class="p">))</span>
                <span class="k">raise</span> <span class="n">QState_Error_Initialize</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">qstate_init</span><span class="p">(</span><span class="n">qubit_num</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">qstate_init_with_vector</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_amp</span><span class="p">())</span>

<div class="viewcode-block" id="QState.reset"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        reset to |00..0&gt; state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list, default - qubit id&#39;s list for all of the qubits</span>
<span class="sd">            qubit id&#39;s list to reset.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If &#39;qid&#39; is set, specified qubits are reset after</span>
<span class="sd">        measurement. So if the specified qubits are entangled with the</span>
<span class="sd">        remaining qubits, output quantum state is probabilistic. If no</span>
<span class="sd">        qubits are set, all qubits are zero reset.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="QState.add_method"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.add_method">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_method</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add method (custum gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : func</span>
<span class="sd">            method (custum gate) to add.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; def bell(self, q0, q1):</span>
<span class="sd">        &gt;&gt;&gt;     self.h(q0).cx(q0,q1)</span>
<span class="sd">        &gt;&gt;&gt;     return self</span>
<span class="sd">        &gt;&gt;&gt; ...</span>
<span class="sd">        &gt;&gt;&gt; QState.add_method(bell)</span>
<span class="sd">        &gt;&gt;&gt; qs = QState(qubit_num=2)</span>
<span class="sd">        &gt;&gt;&gt; qs.bell(0,1)</span>
<span class="sd">        &gt;&gt;&gt; ...</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="QState.add_methods"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.add_methods">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_methods</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">methods</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        add methods (custum gates).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        methods : func, func, ...</span>
<span class="sd">            arguments of methods (custum gates) to add.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; def bell(self, q0, q1):</span>
<span class="sd">        &gt;&gt;&gt;     self.h(q0).cx(q0,q1)</span>
<span class="sd">        &gt;&gt;&gt;     return self</span>
<span class="sd">        &gt;&gt;&gt; ...</span>
<span class="sd">        &gt;&gt;&gt; def flip(self, q0, q1):</span>
<span class="sd">        &gt;&gt;&gt;     self.x(q0).x(q1)</span>
<span class="sd">        &gt;&gt;&gt;     return self</span>
<span class="sd">        &gt;&gt;&gt; ...</span>
<span class="sd">        &gt;&gt;&gt; QState.add_methods(bell, flip, ...)</span>
<span class="sd">        &gt;&gt;&gt; qs = QState(2)</span>
<span class="sd">        &gt;&gt;&gt; qs.bell(0,1)</span>
<span class="sd">        &gt;&gt;&gt; qs.flip(0,1)</span>
<span class="sd">        &gt;&gt;&gt; ...</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">QState_Error_AddMethods</span><span class="p">()</span></div>
            
<div class="viewcode-block" id="QState.create_register"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.create_register">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create_register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        create registers (qubit id&#39;s) and initialize zero.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num : int</span>
<span class="sd">            qubit number you want to use.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; qid = QState.create_register(3)</span>
<span class="sd">        &gt;&gt;&gt; print(qid)</span>
<span class="sd">        [0,0,0]</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">num</span>
        <span class="k">return</span> <span class="n">qid</span></div>

<div class="viewcode-block" id="QState.init_register"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.init_register">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">init_register</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        initialize registers (qubit id&#39;s).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args : list, list,...</span>
<span class="sd">            arguments of qubit registers.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        idx : int</span>
<span class="sd">            total qubit number.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; qid_0 = QState.create_register(3)</span>
<span class="sd">        &gt;&gt;&gt; qid_1 = QState.create_register(2)</span>
<span class="sd">        &gt;&gt;&gt; print(qid_0, qid_1)</span>
<span class="sd">        [0,0,0] [0,0]</span>
<span class="sd">        &gt;&gt;&gt; qnum = QState.init_register(qid_0, qid_1)</span>
<span class="sd">        &gt;&gt;&gt; print(qnum, qid_0, qid_1)</span>
<span class="sd">        5 [0,1,2] [3,4]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                <span class="n">args</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span>
                <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">idx</span></div>
    
<div class="viewcode-block" id="QState.free_all"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.free_all">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">free_all</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">qstates</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        free memory of the all quantum states.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qstates : instance of QState,instance of QState,...</span>
<span class="sd">            set of QState instances</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># for qs in qstates:</span>
        <span class="c1">#     if type(qs) is list or type(qs) is tuple:</span>
        <span class="c1">#         cls.free_all(*qs)</span>
        <span class="c1">#     elif type(qs) is QState:</span>
        <span class="c1">#         qs.free()</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         raise QState_Error_FreeAll()</span>

        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No need to call &#39;free_all&#39; method because free automatically, or you can use class method &#39;del_all&#39; to free memory explicitly.&quot;</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="QState.del_all"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.del_all">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">del_all</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">qstates</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        free memory of the all quantum states.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qstates : instance of QState,instance of QState,...</span>
<span class="sd">            set of QState instances</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">qs</span> <span class="ow">in</span> <span class="n">qstates</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">tuple</span><span class="p">:</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">del_all</span><span class="p">(</span><span class="o">*</span><span class="n">qs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span> <span class="ow">is</span> <span class="n">QState</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">qs</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">QState_Error_FreeAll</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">amp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; elements of quantum state vector. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_amp</span><span class="p">()</span>
        
<div class="viewcode-block" id="QState.get_amp"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.get_amp">[docs]</a>    <span class="k">def</span> <span class="nf">get_amp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the elements of quantum state vector.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list of int, default - list of all of the qubit id</span>
<span class="sd">            qubit id&#39;s list.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ret : list of complex</span>
<span class="sd">            elements of the quantum state vector.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If &#39;qid&#39; is set, specified qubit state are got after remaining</span>
<span class="sd">        qubits are measured. So if the specified qubits are entangled</span>
<span class="sd">        with the remaining qubits, output quantum state is</span>
<span class="sd">        probabilistic. If no qubits are specified, you get all</span>
<span class="sd">        elements of the quantum state.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span>  <span class="n">qstate_get_camp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="QState.partial"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.partial">[docs]</a>    <span class="k">def</span> <span class="nf">partial</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the partial quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list of int, default - list of all of the qubit id</span>
<span class="sd">            qubit id&#39;s list to get as a partial quantum</span>
<span class="sd">            system.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        qs : instance of QState</span>
<span class="sd">            partial quantum state.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If &#39;qid&#39; is set, specified partial quantum system are got</span>
<span class="sd">        after remaining system are measured. So if the specified</span>
<span class="sd">        quantum system are entangled with the remaining system, output</span>
<span class="sd">        quantum state is probabilistic. If no qubits are specified,</span>
<span class="sd">        you get the copy of original quantum state.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_amp</span><span class="p">(</span><span class="n">qid</span><span class="p">)</span>
        <span class="n">qs</span> <span class="o">=</span> <span class="n">QState</span><span class="p">(</span><span class="n">vector</span><span class="o">=</span><span class="n">vec</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">qs</span></div>
        
<div class="viewcode-block" id="QState.show"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nonzero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        show the quantum state </span>
<span class="sd">        (elements of the state vector and probabilities).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list of int, default - list of all of the qubit id</span>
<span class="sd">            qubit id&#39;s list to show.</span>
<span class="sd">        nonzero : bool, default False</span>
<span class="sd">            if True, only non-zero amplitudes are printed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If &#39;qid&#39; is set, it shows the elements of quantum state vector</span>
<span class="sd">        for partial quantum system specified by &#39;qid&#39;. If the</span>
<span class="sd">        specified quantum system are entangled with the remaining</span>
<span class="sd">        system, output is probabilistic. If no qubits are specified,</span>
<span class="sd">        it shows the whole quantum state. This method does not change</span>
<span class="sd">        the original quantum state.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; qs = QState(2).h(0).cx(0,1)</span>
<span class="sd">        &gt;&gt;&gt; qs.show()</span>
<span class="sd">        c[00] = +0.7071+0.0000*i : 0.5000 |++++++</span>
<span class="sd">        c[01] = +0.0000+0.0000*i : 0.0000 |</span>
<span class="sd">        c[10] = +0.0000+0.0000*i : 0.0000 |</span>
<span class="sd">        c[11] = +0.7071+0.0000*i : 0.5000 |++++++</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; qs.show(qid=[0])</span>
<span class="sd">        c[0] = +1.0000+0.0000*i : 1.0000 |+++++++++++</span>
<span class="sd">        c[1] = +0.0000+0.0000*i : 0.0000 |</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; qs.show(nonzero=True)</span>
<span class="sd">        c[00] = +0.7071+0.0000*i : 0.5000 |++++++</span>
<span class="sd">        c[11] = +0.7071+0.0000*i : 0.5000 |++++++</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">,</span> <span class="n">nonzero</span><span class="p">)</span></div>

<div class="viewcode-block" id="QState.clone"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.clone">[docs]</a>    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the copy of the quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        qstate : instance of QState</span>
<span class="sd">            copy of the original quantum state.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate</span> <span class="o">=</span> <span class="n">qstate_copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">qstate</span></div>

<div class="viewcode-block" id="QState.bloch"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.bloch">[docs]</a>    <span class="k">def</span> <span class="nf">bloch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get bloch angles.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : int</span>
<span class="sd">            qubit id</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        theta : float</span>
<span class="sd">            bloch angle with Z-axis</span>
<span class="sd">        phi : float</span>
<span class="sd">            bloch angle with X-axis</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        the unit of angle is PI radian. for example, 0.5 means 0.5*PI</span>
<span class="sd">        (radian).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="o">=</span> <span class="n">qstate_bloch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span></div>

<div class="viewcode-block" id="QState.inpro"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.inpro">[docs]</a>    <span class="k">def</span> <span class="nf">inpro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qstate</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the inner product with quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qstate : instance of QState</span>
<span class="sd">            one of the two quantum state.</span>
<span class="sd">        qid : list of int, default - list of all of the qubit id</span>
<span class="sd">            qubit id&#39;s list.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        inp : complex</span>
<span class="sd">            inner produt (&lt;self|qstate&gt;).</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If &#39;qid&#39; is set, you can get the inner product for partial</span>
<span class="sd">        quantum state. If the specified quantum system are entangled</span>
<span class="sd">        with the remaining system, output value is probabilistic,</span>
<span class="sd">        while original quantum states do not change.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">qid</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">inp</span> <span class="o">=</span> <span class="n">qstate_inner_product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qstate</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qs_0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">)</span>
            <span class="n">qs_1</span> <span class="o">=</span> <span class="n">qstate</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">)</span>
            <span class="n">inp</span> <span class="o">=</span> <span class="n">qstate_inner_product</span><span class="p">(</span><span class="n">qs_0</span><span class="p">,</span> <span class="n">qs_1</span><span class="p">)</span>
            <span class="c1"># qs_0.free()</span>
            <span class="c1"># qs_1.free()</span>
        <span class="k">return</span> <span class="n">inp</span></div>
        
<div class="viewcode-block" id="QState.tenspro"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.tenspro">[docs]</a>    <span class="k">def</span> <span class="nf">tenspro</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qstate</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the tensor product with quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qstate : instance of QState</span>
<span class="sd">            quantum state to get the tensor product.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        qstate_out : instance of QState</span>
<span class="sd">            tensor produt of &#39;self&#39; and &#39;qstate&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_out</span> <span class="o">=</span> <span class="n">qstate_tensor_product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qstate</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">qstate_out</span></div>

<div class="viewcode-block" id="QState.fidelity"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.fidelity">[docs]</a>    <span class="k">def</span> <span class="nf">fidelity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qstate</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the fidelity with quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qstate : instance of QState</span>
<span class="sd">            one of the two quantum state.</span>
<span class="sd">        qid : list of int</span>
<span class="sd">            qubit id&#39;s list.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fid : float</span>
<span class="sd">            fidelity of two quantum states. absolute value of the</span>
<span class="sd">            inner product of two quantum states.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If &#39;qid&#39; is set, you can get the fidelity for partial quantum</span>
<span class="sd">        state. If the specified quantum system are entangled with the</span>
<span class="sd">        remaining system, output value is probabilistic, while</span>
<span class="sd">        original quantum states do not change.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inpro</span><span class="p">(</span><span class="n">qstate</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">))</span></div>

<div class="viewcode-block" id="QState.composite"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.composite">[docs]</a>    <span class="k">def</span> <span class="nf">composite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the composite state of same quantum states.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        num : int</span>
<span class="sd">            number of quantum states.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        qs : instance of QState</span>
<span class="sd">            composite quantum state.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">qs_tmp</span> <span class="o">=</span> <span class="n">qs</span><span class="o">.</span><span class="n">tenspro</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="c1"># qs.free()</span>
                <span class="n">qs</span> <span class="o">=</span> <span class="n">qs_tmp</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
                <span class="c1"># qs_tmp.free()</span>
            <span class="k">return</span> <span class="n">qs</span></div>
        
<div class="viewcode-block" id="QState.join"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.join">[docs]</a>    <span class="k">def</span> <span class="nf">join</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qs_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get tensor product state of the quantum states&#39; list.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qs_list : list (QState)</span>
<span class="sd">            list of quantum states.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        qs_out : instance of QState</span>
<span class="sd">            tensor product state.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qs_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">qs</span> <span class="ow">in</span> <span class="n">qs_list</span><span class="p">:</span>
            <span class="n">qs_tmp</span> <span class="o">=</span> <span class="n">qs_out</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>
            <span class="c1"># qs_out.free()</span>
            <span class="n">qs_out</span> <span class="o">=</span> <span class="n">qs_tmp</span><span class="o">.</span><span class="n">tenspro</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span>
            <span class="c1"># qs_tmp.free()</span>
        <span class="k">return</span> <span class="n">qs_out</span></div>

<div class="viewcode-block" id="QState.evolve"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.evolve">[docs]</a>    <span class="k">def</span> <span class="nf">evolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="nb">iter</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        evolve the quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        observable : instance of Observable</span>
<span class="sd">            Hamiltonian of the system.</span>
<span class="sd">        time : float</span>
<span class="sd">            period of time.</span>
<span class="sd">        iter : int</span>
<span class="sd">            number of iteration.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The &#39;iter&#39; value should be sufficiently larger than the</span>
<span class="sd">        &#39;time&#39; value. This method change the original state.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Obserbable class (Observable.py)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_evolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="nb">iter</span><span class="o">=</span><span class="nb">iter</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>
    
<div class="viewcode-block" id="QState.expect"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.expect">[docs]</a>    <span class="k">def</span> <span class="nf">expect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the expectation value for observable under the quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        observable : instance of Observable</span>
<span class="sd">            obserbable of the system.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        expect : float</span>
<span class="sd">            expect value.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Obserbable class (Observable.py)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expect</span> <span class="o">=</span> <span class="n">qstate_expect_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">observable</span><span class="o">=</span><span class="n">observable</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">expect</span></div>
    
<div class="viewcode-block" id="QState.apply"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.apply">[docs]</a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        apply matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        matrix : list of list</span>
<span class="sd">            matrix to apply.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        If &#39;qid&#39; isn&#39;t set, dimension of the matrix must be equal to</span>
<span class="sd">        the 2 power of qubit number of the system. If &#39;qid&#39; is set,</span>
<span class="sd">        dimension of the matrix must be equal to the 2 power of &#39;qid&#39;</span>
<span class="sd">        length.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_apply_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="k">def</span> <span class="nf">__schmidt_decomp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid_0</span><span class="o">=</span><span class="p">[],</span> <span class="n">qid_1</span><span class="o">=</span><span class="p">[]):</span>

        <span class="n">vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_amp</span><span class="p">(</span><span class="n">qid</span><span class="o">=</span><span class="n">qid_0</span><span class="o">+</span><span class="n">qid_1</span><span class="p">)</span>

        <span class="n">row</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="nb">len</span><span class="p">(</span><span class="n">qid_0</span><span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="nb">len</span><span class="p">(</span><span class="n">qid_1</span><span class="p">)</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">comp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vec</span><span class="p">):</span>
            <span class="n">mat</span><span class="p">[</span><span class="n">idx</span><span class="o">//</span><span class="n">col</span><span class="p">][</span><span class="n">idx</span><span class="o">%</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span>
    
        <span class="n">U</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">coef</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">D</span> <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="n">EPS</span><span class="p">])</span>
        
        <span class="n">vec_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">coef</span><span class="p">)]</span>
        <span class="n">vec_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">coef</span><span class="p">)]</span>
    
        <span class="k">return</span> <span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">vec_0</span><span class="p">,</span> <span class="n">vec_1</span><span class="p">)</span>

<div class="viewcode-block" id="QState.schmidt_decomp"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.schmidt_decomp">[docs]</a>    <span class="k">def</span> <span class="nf">schmidt_decomp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid_0</span><span class="o">=</span><span class="p">[],</span> <span class="n">qid_1</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        schmidt decomposition.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid_0 : list</span>
<span class="sd">            subsystem to decomposite.</span>
<span class="sd">        qid_1 : list</span>
<span class="sd">            another subsystem to decomposite.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        coef : numpy.ndarray</span>
<span class="sd">            schmidt coefficients.</span>
<span class="sd">        qs_0 : list of QState instances</span>
<span class="sd">            decomposite quantum state related to &#39;qid_0&#39;.</span>
<span class="sd">        qs_1 : list of QState instances</span>
<span class="sd">            decomposite quantum state related to &#39;qid_1&#39;.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coef</span><span class="p">,</span> <span class="n">vec_0</span><span class="p">,</span> <span class="n">vec_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__schmidt_decomp</span><span class="p">(</span><span class="n">qid_0</span><span class="o">=</span><span class="n">qid_0</span><span class="p">,</span> <span class="n">qid_1</span><span class="o">=</span><span class="n">qid_1</span><span class="p">)</span>
        <span class="n">qs_0</span> <span class="o">=</span> <span class="p">[</span><span class="n">QState</span><span class="p">(</span><span class="n">vector</span><span class="o">=</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vec_0</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">coef</span><span class="p">)]</span>
        <span class="n">qs_1</span> <span class="o">=</span> <span class="p">[</span><span class="n">QState</span><span class="p">(</span><span class="n">vector</span><span class="o">=</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vec_1</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">coef</span><span class="p">)]</span>
    
        <span class="k">return</span> <span class="p">(</span><span class="n">coef</span><span class="p">,</span> <span class="n">qs_0</span><span class="p">,</span> <span class="n">qs_1</span><span class="p">)</span></div>

<div class="viewcode-block" id="QState.schmidt_coef"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.schmidt_coef">[docs]</a>    <span class="k">def</span> <span class="nf">schmidt_coef</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid_0</span><span class="o">=</span><span class="p">[],</span> <span class="n">qid_1</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get schmidt coefficients.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid_0 : list</span>
<span class="sd">            subsystem to decomposite.</span>
<span class="sd">        qid_1 : list</span>
<span class="sd">            another subsystem to decomposite.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        coef : numpy.ndarray</span>
<span class="sd">            schmidt coefficients.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coef</span><span class="p">,</span> <span class="n">vec_0</span><span class="p">,</span> <span class="n">vec_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__schmidt_decomp</span><span class="p">(</span><span class="n">qid_0</span><span class="o">=</span><span class="n">qid_0</span><span class="p">,</span> <span class="n">qid_1</span><span class="o">=</span><span class="n">qid_1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coef</span></div>

    <span class="c1"># 1-qubit gate</span>

<div class="viewcode-block" id="QState.x"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.x">[docs]</a>    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate X gate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">PAULI_X</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.y"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.y">[docs]</a>    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate Y gate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">PAULI_Y</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.z"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.z">[docs]</a>    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate Z gate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">PAULI_Z</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.xr"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.xr">[docs]</a>    <span class="k">def</span> <span class="nf">xr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate root X gate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">ROOT_PAULI_X</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.xr_dg"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.xr_dg">[docs]</a>    <span class="k">def</span> <span class="nf">xr_dg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate root X dagger gate </span>
<span class="sd">        (hermmitian conjugate of root X gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">ROOT_PAULI_X_</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.h"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.h">[docs]</a>    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate H gate (hadamard gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">HADAMARD</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.s"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.s">[docs]</a>    <span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate S gate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">PHASE_SHIFT_S</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.s_dg"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.s_dg">[docs]</a>    <span class="k">def</span> <span class="nf">s_dg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate S dagger gate (hermitian conjugate of S gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">PHASE_SHIFT_S_</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.t"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.t">[docs]</a>    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate T gate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">PHASE_SHIFT_T</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.t_dg"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.t_dg">[docs]</a>    <span class="k">def</span> <span class="nf">t_dg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate T dagger gate (hermitian conjugate of T gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">PHASE_SHIFT_T_</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.rx"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.rx">[docs]</a>    <span class="k">def</span> <span class="nf">rx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate RX gate (rotation around X-axis).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>
<span class="sd">        phase : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">ROTATION_X</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.ry"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.ry">[docs]</a>    <span class="k">def</span> <span class="nf">ry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate RY gate (rotation around Y-axis).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>
<span class="sd">        phase : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">ROTATION_Y</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.rz"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.rz">[docs]</a>    <span class="k">def</span> <span class="nf">rz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate RZ gate (rotation around Z-axis).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>
<span class="sd">        phase : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">ROTATION_Z</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.p"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.p">[docs]</a>    <span class="k">def</span> <span class="nf">p</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate P gate (phase shift gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>
<span class="sd">        phase : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        matrix expression is following...</span>
<span class="sd">        | 1.0 0.0             |</span>
<span class="sd">        | 0.0 exp(i*phase*PI) |</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">PHASE_SHIFT</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.u1"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.u1">[docs]</a>    <span class="k">def</span> <span class="nf">u1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate U1 gate (by IBM).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>
<span class="sd">        alpha : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        this opration is equal to P gate (phase shift gate)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">ROTATION_U1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.u2"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.u2">[docs]</a>    <span class="k">def</span> <span class="nf">u2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate U2 gate (by IBM).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>
<span class="sd">        alpha : float</span>
<span class="sd">            rotation angle (unit of angle is pi radian).</span>
<span class="sd">        beta : float</span>
<span class="sd">            rotation angle (unit of angle is pi radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        matrix experssion is following...</span>
<span class="sd">        | 1/sqrt(2)              -exp(i*alpha*PI)/sqrt(2)       |</span>
<span class="sd">        | exp(i*beta*PI)/sqrt(2) exp(i*(alpha+beta)*PI)/sqrt(2) |</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">ROTATION_U2</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phase1</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.u3"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.u3">[docs]</a>    <span class="k">def</span> <span class="nf">u3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate U3 gate (by IBM).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id.</span>
<span class="sd">        alpha : float</span>
<span class="sd">            rotation angle (unit of angle is pi radian).</span>
<span class="sd">        beta : float</span>
<span class="sd">            rotation angle (unit of angle is pi radian).</span>
<span class="sd">        gamma : float</span>
<span class="sd">            rotation angle (unit of angle is pi radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        matrix expression is following...</span>
<span class="sd">        | cos(gamma/2)                -exp(i*alpha*PI)*sin(gamma/2)       |</span>
<span class="sd">        | exp(i*beta*PI)*sin(gamma/2) exp(i*(alpha+beta)*PI)*cos(gamma/2) |</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">ROTATION_U3</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phase1</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>
                             <span class="n">phase2</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="c1"># 2-qubit gate</span>

<div class="viewcode-block" id="QState.cx"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cx">[docs]</a>    <span class="k">def</span> <span class="nf">cx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CX gate (controlled X gate, controlled NOT gate, CNOT gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_X</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cy"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cy">[docs]</a>    <span class="k">def</span> <span class="nf">cy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CY gate (controlled X gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_Y</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cz"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cz">[docs]</a>    <span class="k">def</span> <span class="nf">cz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CZ gate (controlled Z gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_Z</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cxr"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cxr">[docs]</a>    <span class="k">def</span> <span class="nf">cxr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CXR gate (controlled root X gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_XR</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cxr_dg"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cxr_dg">[docs]</a>    <span class="k">def</span> <span class="nf">cxr_dg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CXR dagger gate (controlled XR dagger gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_XR_</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.ch"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.ch">[docs]</a>    <span class="k">def</span> <span class="nf">ch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CH gate (controlled H gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_H</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cs"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cs">[docs]</a>    <span class="k">def</span> <span class="nf">cs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CS gate (controlled S gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_S</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cs_dg"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cs_dg">[docs]</a>    <span class="k">def</span> <span class="nf">cs_dg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CS dagger gate (controlled S dagger gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_S_</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.ct"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.ct">[docs]</a>    <span class="k">def</span> <span class="nf">ct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CT gate (controlled T gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_T</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.ct_dg"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.ct_dg">[docs]</a>    <span class="k">def</span> <span class="nf">ct_dg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CT dagger gate (controlled T dagger gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_T_</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.sw"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.sw">[docs]</a>    <span class="k">def</span> <span class="nf">sw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        swap gate</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">SWAP_QUBITS</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cp"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cp">[docs]</a>    <span class="k">def</span> <span class="nf">cp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CP gate (controlled P gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_P</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.crx"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.crx">[docs]</a>    <span class="k">def</span> <span class="nf">crx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CRX gate (controlled RX gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>
<span class="sd">        phase : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_RX</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cry"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cry">[docs]</a>    <span class="k">def</span> <span class="nf">cry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CRY gate (controlled RY gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>
<span class="sd">        phase : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_RY</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.crz"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.crz">[docs]</a>    <span class="k">def</span> <span class="nf">crz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CRZ gate (controlled RZ gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>
<span class="sd">        phase : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_RZ</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cu1"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cu1">[docs]</a>    <span class="k">def</span> <span class="nf">cu1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CU1 gate (controlled U1 gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>
<span class="sd">        alpha : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_U1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cu2"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cu2">[docs]</a>    <span class="k">def</span> <span class="nf">cu2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CU2 gate (controlled U2 gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>
<span class="sd">        alpha : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>
<span class="sd">        beta : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_U2</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phase1</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>
                             <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.cu3"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.cu3">[docs]</a>    <span class="k">def</span> <span class="nf">cu3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">DEF_PHASE</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CU3 gate (controlled U3 gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (target qubit).</span>
<span class="sd">        alpha : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>
<span class="sd">        beta : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>
<span class="sd">        gamma : float</span>
<span class="sd">            rotation angle (unit of angle is PI radian).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_operate_qgate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">CONTROLLED_U3</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">phase1</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span>
                             <span class="n">phase2</span><span class="o">=</span><span class="n">gamma</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="p">[</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="c1"># 3-qubit gate</span>
    
<div class="viewcode-block" id="QState.ccx"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.ccx">[docs]</a>    <span class="k">def</span> <span class="nf">ccx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CCX gate (toffoli gate, controlled controlled X gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q2 : int</span>
<span class="sd">            qubit id (target qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cxr</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">)</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">)</span><span class="o">.</span><span class="n">cxr_dg</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">)</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">)</span><span class="o">.</span><span class="n">cxr</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="n">q2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.csw"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.csw">[docs]</a>    <span class="k">def</span> <span class="nf">csw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate CSW gate (fredkin gate, controlled swap gate).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q0 : int</span>
<span class="sd">            qubit id (control qubit).</span>
<span class="sd">        q1 : int</span>
<span class="sd">            qubit id (swap qubit).</span>
<span class="sd">        q2 : int</span>
<span class="sd">            qubit id (swap qubit).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span><span class="n">q1</span><span class="p">)</span><span class="o">.</span><span class="n">ccx</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">)</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span><span class="n">q1</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>

    <span class="c1"># other gate</span>

<div class="viewcode-block" id="QState.mcx"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.mcx">[docs]</a>    <span class="k">def</span> <span class="nf">mcx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">qid</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate MCX gate (multi-controlled X gate).</span>
<span class="sd">    </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list of int</span>
<span class="sd">            qubit id list [control, control, ... , control, target]</span>
<span class="sd">    </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>
<span class="sd">    </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">qstate_mcx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>
    
    <span class="c1"># measurement</span>
    
<div class="viewcode-block" id="QState.m"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.m">[docs]</a>    <span class="k">def</span> <span class="nf">m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">DEF_SHOTS</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        measurement in any direction (default: Z-axis).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list of int</span>
<span class="sd">            qubit id list to measure.</span>
<span class="sd">        shots : int, default 1</span>
<span class="sd">            number of measurements.</span>
<span class="sd">        angle : float, default 0.0</span>
<span class="sd">            direction of measurement (angle with Z-axis).</span>
<span class="sd">        phase : float, default 0.0</span>
<span class="sd">            direction of measurement (phase around Z-axis).</span>
<span class="sd">        tag : str</span>
<span class="sd">            tag of measurement data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        md : instance of MData</span>
<span class="sd">            measurement data.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; qs = QState(2).h(0).cx(0,1)</span>
<span class="sd">        &gt;&gt;&gt; md = qs.m()</span>
<span class="sd">        &gt;&gt;&gt; md.show(shots=100)</span>
<span class="sd">        direction of measurement: z-axis</span>
<span class="sd">        frq[00] = 52</span>
<span class="sd">        frq[11] = 48</span>
<span class="sd">        last state =&gt; 11</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        MData class (MData.py)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">md</span> <span class="o">=</span> <span class="n">qstate_measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MDATA_TABLE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span>
                              <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">md</span></div>
        
<div class="viewcode-block" id="QState.mx"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.mx">[docs]</a>    <span class="k">def</span> <span class="nf">mx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">DEF_SHOTS</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        X-axis measurement.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list of int</span>
<span class="sd">            qubit id list to measure.</span>
<span class="sd">        shots : int, default 1</span>
<span class="sd">            number of measurements.</span>
<span class="sd">        tag : str</span>
<span class="sd">            tag of measurement data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        md : instance of MData</span>
<span class="sd">            measurement data.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        MData class (MData.py)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">md</span> <span class="o">=</span> <span class="n">qstate_measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MDATA_TABLE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span>
                              <span class="n">angle</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">md</span></div>
        
<div class="viewcode-block" id="QState.my"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.my">[docs]</a>    <span class="k">def</span> <span class="nf">my</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">DEF_SHOTS</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Y-axis measurement.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list of int</span>
<span class="sd">            qubit id list to measure.</span>
<span class="sd">        shots : int, default 1</span>
<span class="sd">            number of measurements.</span>
<span class="sd">        tag : str</span>
<span class="sd">            tag of measurement data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        md : instance of MData</span>
<span class="sd">            measurement data.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        MData class (MData.py)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">md</span> <span class="o">=</span>  <span class="n">qstate_measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MDATA_TABLE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span>
                              <span class="n">angle</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">md</span></div>
        
<div class="viewcode-block" id="QState.mz"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.mz">[docs]</a>    <span class="k">def</span> <span class="nf">mz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">DEF_SHOTS</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Z-axis measurement.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qid : list of int</span>
<span class="sd">            qubit id list to measure.</span>
<span class="sd">        shots : int, default 1</span>
<span class="sd">            number of measurements.</span>
<span class="sd">        tag : str</span>
<span class="sd">            tag of measurement data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        md : instance of MData</span>
<span class="sd">            measurement data.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        MData class (MData.py)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">md</span> <span class="o">=</span>  <span class="n">qstate_measure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MDATA_TABLE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span>
                              <span class="n">angle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">md</span></div>

<div class="viewcode-block" id="QState.mb"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.mb">[docs]</a>    <span class="k">def</span> <span class="nf">mb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">DEF_SHOTS</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">qstate_measure_bell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">MDATA_TABLE</span><span class="p">,</span> <span class="n">qid</span><span class="o">=</span><span class="n">qid</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="n">shots</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">tag</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="QState.m_value"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.m_value">[docs]</a>    <span class="k">def</span> <span class="nf">m_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">binary</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get measurement value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tag : str</span>
<span class="sd">            tag of measurement data.</span>
<span class="sd">        angle : float, default 0.0</span>
<span class="sd">            direction of measurement (angle with Z-axis).</span>
<span class="sd">        phase : float, default 0.0</span>
<span class="sd">            direction of measurement (phase around Z-axis).</span>
<span class="sd">        binary : bool</span>
<span class="sd">            format of measurement value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mval : str (binary:True) or int (binary:False)</span>
<span class="sd">            measurement value (if shots&gt;1, last measured value).</span>
<span class="sd">            - binary=True -&gt; &#39;00&#39;,&#39;01&#39;,&#39;10&#39;,&#39;11&#39; for 2 qubits measurement</span>
<span class="sd">            - binary=False -&gt; 0,1,2,3 for 2 qubits measurement</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; qs = QState(2).h(0).cx(0,1)</span>
<span class="sd">        &gt;&gt;&gt; qs.m(shots=100)</span>
<span class="sd">        &gt;&gt;&gt; print(qs.m_value(binary=True))</span>
<span class="sd">        00</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">DEF_TAG</span>
        <span class="n">tag_long</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">tag</span>
        <span class="n">mval</span> <span class="o">=</span> <span class="n">MDATA_TABLE</span><span class="p">[</span><span class="n">tag_long</span><span class="p">]</span><span class="o">.</span><span class="n">measured_value</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">binary</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">digits</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">MDATA_TABLE</span><span class="p">[</span><span class="n">tag_long</span><span class="p">]</span><span class="o">.</span><span class="n">qid</span><span class="p">)</span>
            <span class="n">mval</span> <span class="o">=</span> <span class="s1">&#39;{:0</span><span class="si">{digits}</span><span class="s1">b}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mval</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="n">digits</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mval</span></div>

<div class="viewcode-block" id="QState.m_bit"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.m_bit">[docs]</a>    <span class="k">def</span> <span class="nf">m_bit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">boolean</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get measured bit value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : int</span>
<span class="sd">        tag : str</span>
<span class="sd">            tag of measurement data.</span>
<span class="sd">        angle : float, default 0.0</span>
<span class="sd">            direction of measurement (angle with Z-axis).</span>
<span class="sd">        phase : float, default 0.0</span>
<span class="sd">            direction of measurement (phase around Z-axis).</span>
<span class="sd">        boolean : bool</span>
<span class="sd">            format of measured bit.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mbit : bool (boolean:True) or int (boolean:False)</span>
<span class="sd">            measured bit value (if shots&gt;1, last measured bit value).</span>
<span class="sd">            - boolean=True -&gt; False,True</span>
<span class="sd">            - boolean=False -&gt; 0,1</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; qs = QState(2).h(0).cx(0,1)</span>
<span class="sd">        &gt;&gt;&gt; qs.m(shots=100)</span>
<span class="sd">        &gt;&gt;&gt; print(qs.m_bit(boolean=True))</span>
<span class="sd">        True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">DEF_TAG</span>
        <span class="n">tag_long</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">tag</span>
        <span class="n">mbit</span> <span class="o">=</span>  <span class="n">MDATA_TABLE</span><span class="p">[</span><span class="n">tag_long</span><span class="p">]</span><span class="o">.</span><span class="n">measured_bit</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">boolean</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">mbit</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">mbit</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mbit</span></div>
        
<div class="viewcode-block" id="QState.m_freq"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.m_freq">[docs]</a>    <span class="k">def</span> <span class="nf">m_freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get measurement value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tag : str</span>
<span class="sd">            tag of measurement data.</span>
<span class="sd">        angle : float, default 0.0</span>
<span class="sd">            direction of measurement (angle with Z-axis).</span>
<span class="sd">        phase : float, default 0.0</span>
<span class="sd">            direction of measurement (phase around Z-axis).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mfrq : instance of Counter from collection (Python standard library)</span>
<span class="sd">            measurement frequency.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; qs = QState(2).h(0).cx(0,1)</span>
<span class="sd">        &gt;&gt;&gt; qs.m(shots=100)</span>
<span class="sd">        &gt;&gt;&gt; print(qs.m_freq())</span>
<span class="sd">        Counter({&#39;11&#39;: 53, &#39;00&#39;: 47})</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">tag</span> <span class="o">=</span> <span class="n">DEF_TAG</span>
        <span class="n">tag_long</span> <span class="o">=</span> <span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">tag</span>
        <span class="n">mfrq</span> <span class="o">=</span> <span class="n">MDATA_TABLE</span><span class="p">[</span><span class="n">tag_long</span><span class="p">]</span><span class="o">.</span><span class="n">measured_freq</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mfrq</span></div>

<div class="viewcode-block" id="QState.operate"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.operate">[docs]</a>    <span class="k">def</span> <span class="nf">operate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ctrl</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        operate unitary operator to quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pp : instance of PauliProduct</span>
<span class="sd">            pauli product to operate</span>
<span class="sd">        ctrl : int</span>
<span class="sd">            contoroll qubit id for controlled pauli product</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self : instance of QState</span>
<span class="sd">            quantum state after operation</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pauli_list</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">pauli_list</span>
        <span class="n">qid</span> <span class="o">=</span> <span class="n">pp</span><span class="o">.</span><span class="n">qid</span>
    
        <span class="k">if</span> <span class="n">ctrl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">q</span><span class="p">,</span> <span class="n">pauli</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">qid</span><span class="p">,</span> <span class="n">pauli_list</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">pauli</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">pauli</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">pauli</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ctrl</span> <span class="ow">in</span> <span class="n">qid</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;controll and target qubit id conflict&quot;</span><span class="p">)</span>
        
            <span class="k">for</span> <span class="n">q</span><span class="p">,</span> <span class="n">pauli</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">qid</span><span class="p">,</span> <span class="n">pauli_list</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">pauli</span> <span class="o">==</span> <span class="s1">&#39;X&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cx</span><span class="p">(</span><span class="n">ctrl</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">pauli</span> <span class="o">==</span> <span class="s1">&#39;Y&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cy</span><span class="p">(</span><span class="n">ctrl</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">pauli</span> <span class="o">==</span> <span class="s1">&#39;Z&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cz</span><span class="p">(</span><span class="n">ctrl</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
    
        <span class="k">return</span> <span class="bp">self</span></div>

<div class="viewcode-block" id="QState.free"><a class="viewcode-back" href="../../python-api/qlazy.html#qlazy.QState.QState.free">[docs]</a>    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        free memory of quantum state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># qstate_free(self)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;No need to call &#39;free&#39; method because free automatically, or you can use &#39;del&#39; to free memory explicitly.&quot;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">qstate_free</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<span class="c1"># c-library for qstate</span>
<span class="kn">from</span> <span class="nn">qlazy.lib.qstate_c</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Sam.N.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>